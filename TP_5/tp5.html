<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Group 05:">
<meta name="author" content="- NANG Sreynich">
<meta name="author" content="- NEOM Koemhak">
<meta name="author" content="- OUN Vikteth">

<title>ARIMA Model Expectations and Variances</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tp5_files/libs/clipboard/clipboard.min.js"></script>
<script src="tp5_files/libs/quarto-html/quarto.js"></script>
<script src="tp5_files/libs/quarto-html/popper.min.js"></script>
<script src="tp5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tp5_files/libs/quarto-html/anchor.min.js"></script>
<link href="tp5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tp5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tp5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tp5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tp5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ARIMA Model Expectations and Variances</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p><strong>Group 05:</strong> </p>
             <p>- NANG Sreynich </p>
             <p>- NEOM Koemhak </p>
             <p>- OUN Vikteth </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="ex-5.1" class="level3">
<h3 class="anchored" data-anchor-id="ex-5.1">Ex 5.1</h3>
<p>Identify the following as specific ARIMA models. That is, what are p,d, and q and what are the values of the parameters (the <span class="math inline">\(\phi\)</span>’s and <span class="math inline">\(\theta\)</span>’s)?</p>
<p>a). <span class="math inline">\(Y_t = Y_{t-1} - 0.25 Y_{t-2} + e_t - 0.1 e_{t-1}\)</span></p>
<p>b). <span class="math inline">\(Y_t = 2 Y_{t-1} - Y_{t-2} + e_t\)</span></p>
<p>c). <span class="math inline">\(Y_t = 0.5 Y_{t-2} + e_t + 0.25 e_{t-2}\)</span></p>
</section>
<section id="solution" class="level2">
<h2 class="anchored" data-anchor-id="solution">Solution</h2>
<section id="part-a" class="level3">
<h3 class="anchored" data-anchor-id="part-a">Part (a)</h3>
<p>Given: <span class="math display">\[
Y_t = Y_{t-1} - 0.25 Y_{t-2} + e_t - 0.1 e_{t-1}
\]</span></p>
<p><strong>Analysis</strong>:</p>
<ul>
<li>This model has AR terms and MA terms but no differencing, so <span class="math inline">\(d = 0\)</span>.</li>
<li><strong>AR terms</strong>:
<ul>
<li>Coefficient of <span class="math inline">\(Y_{t-1}\)</span>: <span class="math inline">\(\phi_1 = 1\)</span></li>
<li>Coefficient of <span class="math inline">\(Y_{t-2}\)</span>: <span class="math inline">\(\phi_2 = -0.25\)</span></li>
<li>Therefore, <span class="math inline">\(p = 2\)</span>.</li>
</ul></li>
<li><strong>MA terms</strong>:
<ul>
<li>Coefficient of <span class="math inline">\(e_{t-1}\)</span>: <span class="math inline">\(\theta_1 = -0.1\)</span></li>
<li>Therefore, <span class="math inline">\(q = 1\)</span>.</li>
</ul></li>
</ul>
<p><strong>Conclusion</strong>:<br>
The model is an <strong>ARIMA(2, 0, 1)</strong> with: - <span class="math inline">\(\phi_1 = 1\)</span>, <span class="math inline">\(\phi_2 = -0.25\)</span> - <span class="math inline">\(\theta_1 = -0.1\)</span></p>
<hr>
</section>
<section id="part-b" class="level3">
<h3 class="anchored" data-anchor-id="part-b">Part (b)</h3>
<p>Given: <span class="math display">\[
Y_t = 2 Y_{t-1} - Y_{t-2} + e_t
\]</span></p>
<p><strong>Analysis</strong>:</p>
<ul>
<li>This model has AR terms but no MA terms and no differencing, so <span class="math inline">\(d = 0\)</span>.</li>
<li><strong>AR terms</strong>:
<ul>
<li>Coefficient of <span class="math inline">\(Y_{t-1}\)</span>: <span class="math inline">\(\phi_1 = 2\)</span></li>
<li>Coefficient of <span class="math inline">\(Y_{t-2}\)</span>: <span class="math inline">\(\phi_2 = -1\)</span></li>
<li>Therefore, <span class="math inline">\(p = 2\)</span>.</li>
</ul></li>
<li><strong>MA terms</strong>:
<ul>
<li>None, so <span class="math inline">\(q = 0\)</span>.</li>
</ul></li>
</ul>
<p><strong>Conclusion</strong>:<br>
The model is an <strong>ARIMA(2, 0, 0)</strong> with: - <span class="math inline">\(\phi_1 = 2\)</span>, <span class="math inline">\(\phi_2 = -1\)</span></p>
<hr>
</section>
<section id="part-c" class="level3">
<h3 class="anchored" data-anchor-id="part-c">Part (c)</h3>
<p>Given: <span class="math display">\[
Y_t = 0.5 Y_{t-2} + e_t + 0.25 e_{t-2}
\]</span></p>
<p><strong>Analysis</strong>:</p>
<ul>
<li>This model has AR and MA terms but no differencing, so <span class="math inline">\(d = 0\)</span>.</li>
<li><strong>AR terms</strong>:
<ul>
<li>Coefficient of <span class="math inline">\(Y_{t-2}\)</span>: <span class="math inline">\(\phi_2 = 0.5\)</span></li>
<li>No <span class="math inline">\(Y_{t-1}\)</span> term, so <span class="math inline">\(\phi_1 = 0\)</span></li>
<li>Therefore, <span class="math inline">\(p = 2\)</span> (since <span class="math inline">\(\phi_2 \neq 0\)</span>).</li>
</ul></li>
<li><strong>MA terms</strong>:
<ul>
<li>Coefficient of <span class="math inline">\(e_{t-2}\)</span>: <span class="math inline">\(\theta_2 = 0.25\)</span></li>
<li>No <span class="math inline">\(e_{t-1}\)</span> term, so <span class="math inline">\(\theta_1 = 0\)</span></li>
<li>Therefore, <span class="math inline">\(q = 2\)</span>.</li>
</ul></li>
</ul>
<p><strong>Conclusion</strong>:<br>
The model is an <strong>ARIMA(2, 0, 2)</strong> with: - <span class="math inline">\(\phi_1 = 0\)</span>, <span class="math inline">\(\phi_2 = 0.5\)</span> - <span class="math inline">\(\theta_1 = 0\)</span>, <span class="math inline">\(\theta_2 = 0.25\)</span></p>
<hr>
</section>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Model</th>
<th>ARIMA(p, d, q)</th>
<th><span class="math inline">\(\phi\)</span>’s</th>
<th><span class="math inline">\(\theta\)</span>’s</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(a)</td>
<td>ARIMA(2, 0, 1)</td>
<td><span class="math inline">\(\phi_1 = 1\)</span>, <span class="math inline">\(\phi_2 = -0.25\)</span></td>
<td><span class="math inline">\(\theta_1 = -0.1\)</span></td>
</tr>
<tr class="even">
<td>(b)</td>
<td>ARIMA(2, 0, 0)</td>
<td><span class="math inline">\(\phi_1 = 2\)</span>, <span class="math inline">\(\phi_2 = -1\)</span></td>
<td>None</td>
</tr>
<tr class="odd">
<td>(c)</td>
<td>ARIMA(2, 0, 2)</td>
<td><span class="math inline">\(\phi_1 = 0\)</span>, <span class="math inline">\(\phi_2 = 0.5\)</span></td>
<td><span class="math inline">\(\theta_1 = 0\)</span>, <span class="math inline">\(\theta_2 = 0.25\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="ex-5.2" class="level3">
<h3 class="anchored" data-anchor-id="ex-5.2"><strong>Ex 5.2</strong></h3>
<p>For each of the ARIMA models below, calculate the values for <span class="math inline">\(E(\nabla Y_t)\)</span> and <span class="math inline">\(\text{Var}(\nabla Y_t)\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(Y_t = 3 + Y_{t-1} + e_t - 0.75 e_{t-1}\)</span></li>
<li><span class="math inline">\(Y_t = 10 + 1.25 Y_{t-1} - 0.25 Y_{t-2} + e_t - 0.5 e_{t-1} + 0.25 e_{t-2}\)</span></li>
<li><span class="math inline">\(Y_t = 5 + 2 Y_{t-1} - 1.7 Y_{t-2} + 0.7 Y_{t-3} + e_t - 0.5 e_{t-1} + 0.25 e_{t-2}\)</span></li>
</ol>
</section>
</section>
<section id="solution-1" class="level2">
<h2 class="anchored" data-anchor-id="solution-1">Solution</h2>
<section id="part-a-1" class="level3">
<h3 class="anchored" data-anchor-id="part-a-1">Part (a)</h3>
<p>Given: <span class="math display">\[
Y_t = 3 + Y_{t-1} + e_t - 0.75 e_{t-1}
\]</span></p>
<section id="first-difference" class="level4">
<h4 class="anchored" data-anchor-id="first-difference"><strong>First Difference</strong>:</h4>
<p>The first difference is: <span class="math display">\[
\nabla Y_t = Y_t - Y_{t-1}
\]</span></p>
<p>Substitute the expression for <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-1\)</span>:</p>
<p><span class="math display">\[
\nabla Y_t = (3 + Y_{t-1} + e_t - 0.75 e_{t-1}) - (3 + Y_{t-2} + e_{t-1} - 0.75 e_{t-2})
\]</span> Simplify: <span class="math display">\[
\nabla Y_t = Y_{t-1} - Y_{t-2} + e_t - 0.75 e_{t-1} - e_{t-1} + 0.75 e_{t-2}
\]</span> Thus, the difference becomes: <span class="math display">\[
\nabla Y_t = Y_{t-1} - Y_{t-2} + e_t - 1.75 e_{t-1} + 0.75 e_{t-2}
\]</span></p>
</section>
<section id="expectation" class="level4">
<h4 class="anchored" data-anchor-id="expectation"><strong>Expectation</strong>:</h4>
<p>Since <span class="math inline">\(E(e_t) = 0\)</span>, we get: <span class="math display">\[
E(\nabla Y_t) = E(Y_{t-1} - Y_{t-2}) + 0 = 0
\]</span> Therefore, <span class="math display">\[
E(\nabla Y_t) = 0
\]</span></p>
</section>
<section id="variance" class="level4">
<h4 class="anchored" data-anchor-id="variance"><strong>Variance</strong>:</h4>
<p>The variance of <span class="math inline">\(\nabla Y_t\)</span> is based on the error terms:</p>
<p><span class="math display">\[
\text{Var}(\nabla Y_t) = \text{Var}(e_t - 1.75 e_{t-1} + 0.75 e_{t-2})
\]</span></p>
<p>Assuming the errors <span class="math inline">\(e_t\)</span> are independent with variance <span class="math inline">\(\sigma^2\)</span>, we get:</p>
<p><span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 (1^2 + (-1.75)^2 + 0.75^2)
\]</span> Calculate: <span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 (1 + 3.0625 + 0.5625) = \sigma^2 \times 4.625
\]</span></p>
<p>Therefore: <span class="math display">\[
\text{Var}(\nabla Y_t) = 4.625 \sigma^2
\]</span></p>
<hr>
</section>
</section>
<section id="part-b-1" class="level3">
<h3 class="anchored" data-anchor-id="part-b-1">Part (b)</h3>
<p>Given: <span class="math display">\[
Y_t = 10 + 1.25 Y_{t-1} - 0.25 Y_{t-2} + e_t - 0.5 e_{t-1} + 0.25 e_{t-2}
\]</span></p>
<section id="first-difference-1" class="level4">
<h4 class="anchored" data-anchor-id="first-difference-1"><strong>First Difference</strong>:</h4>
<p>The first difference is: <span class="math display">\[
\nabla Y_t = Y_t - Y_{t-1}
\]</span> Substitute the expression for<span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-1}\)</span>: <span class="math display">\[
\nabla Y_t = (10 + 1.25 Y_{t-1} - 0.25 Y_{t-2} + e_t - 0.5 e_{t-1} + 0.25 e_{t-2}) - (10 + 1.25 Y_{t-2} - 0.25 Y_{t-3} + e_{t-1} - 0.5 e_{t-2} + 0.25 e_{t-3})
\]</span> Simplify: <span class="math display">\[
\nabla Y_t = 1.25 (Y_{t-1} - Y_{t-2}) + e_t - 0.5 e_{t-1} + 0.25 e_{t-2} - e_{t-1} + 0.5 e_{t-2}
\]</span> Thus: <span class="math display">\[
\nabla Y_t = 1.25 (Y_{t-1} - Y_{t-2}) + e_t - 1.5 e_{t-1} + 0.75 e_{t-2}
\]</span></p>
</section>
<section id="expectation-1" class="level4">
<h4 class="anchored" data-anchor-id="expectation-1"><strong>Expectation</strong>:</h4>
<p>Since <span class="math inline">\(E(e_t) = 0\)</span>, we get: <span class="math display">\[
E(\nabla Y_t) = 0
\]</span></p>
</section>
<section id="variance-1" class="level4">
<h4 class="anchored" data-anchor-id="variance-1"><strong>Variance</strong>:</h4>
<p>Assuming the errors <span class="math inline">\(e_t\)</span> have variance <span class="math inline">\(\sigma^2\)</span>, we calculate:</p>
<p><span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 (1^2 + (-1.5)^2 + 0.75^2) = \sigma^2 (1 + 2.25 + 0.5625)
\]</span> Therefore: <span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 \times 3.8125
\]</span></p>
<hr>
</section>
</section>
<section id="part-c-1" class="level3">
<h3 class="anchored" data-anchor-id="part-c-1">Part (c)</h3>
<p>Given: <span class="math display">\[
Y_t = 5 + 2 Y_{t-1} - 1.7 Y_{t-2} + 0.7 Y_{t-3} + e_t - 0.5 e_{t-1} + 0.25 e_{t-2}
\]</span></p>
<section id="first-difference-2" class="level4">
<h4 class="anchored" data-anchor-id="first-difference-2"><strong>First Difference</strong>:</h4>
<p>The first difference is: <span class="math display">\[
\nabla Y_t = Y_t - Y_{t-1}
\]</span> Substitute the expression for <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y_{t-1}\)</span>:</p>
<p><span class="math display">\[
\nabla Y_t = (5 + 2 Y_{t-1} - 1.7 Y_{t-2} + 0.7 Y_{t-3} + e_t - 0.5 e_{t-1} + 0.25 e_{t-2}) - (5 + 2 Y_{t-2} - 1.7 Y_{t-3} + 0.7 Y_{t-4} + e_{t-1} - 0.5 e_{t-2} + 0.25 e_{t-3})
\]</span> Simplify: <span class="math display">\[
\nabla Y_t = 2 (Y_{t-1} - Y_{t-2}) - 1.7 (Y_{t-2} - Y_{t-3}) + 0.7 (Y_{t-3} - Y_{t-4}) + e_t - e_{t-1} + 0.25 (e_{t-2} - e_{t-3})
\]</span></p>
</section>
<section id="expectation-2" class="level4">
<h4 class="anchored" data-anchor-id="expectation-2"><strong>Expectation</strong>:</h4>
<p>Since <span class="math inline">\(E(e_t) = 0\)</span>, we get:</p>
<p><span class="math display">\[
E(\nabla Y_t) = 0
\]</span></p>
</section>
<section id="variance-2" class="level4">
<h4 class="anchored" data-anchor-id="variance-2"><strong>Variance</strong>:</h4>
<p>Again, assuming the errors have variance <span class="math inline">\(\sigma^2\)</span>, we calculate:</p>
<p><span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 (1^2 + (-1)^2 + 0.25^2)
\]</span> Thus: <span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 \times (1 + 1 + 0.0625) = \sigma^2 \times 2.0625
\]</span></p>
<hr>
</section>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">Summary</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Model</th>
<th><span class="math inline">\(E(\nabla Y_t)\)</span></th>
<th><span class="math inline">\(\text{Var}(\nabla Y_t)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(a)</td>
<td>0</td>
<td><span class="math inline">\(4.625 \sigma^2\)</span></td>
</tr>
<tr class="even">
<td>(b)</td>
<td>0</td>
<td><span class="math inline">\(3.8125 \sigma^2\)</span></td>
</tr>
<tr class="odd">
<td>(c)</td>
<td>0</td>
<td><span class="math inline">\(2.0625 \sigma^2\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="ex-5.3" class="level3">
<h3 class="anchored" data-anchor-id="ex-5.3"><strong>Ex 5.3</strong></h3>
<p>Consider the time series process:</p>
<p><span class="math display">\[
Y_t = e_t + c e_{t-1} + c e_{t-2} + c e_{t-3} + \dots + c e_0
\]</span></p>
<p>Where ( e_t ) is white noise with ( E(e_t) = 0 ) and ( (e_t) = ^2 ) for all ( t ), and ( c ) is a constant.</p>
</section>
<section id="part-a---mean-and-covariance-functions-for-y_t" class="level3">
<h3 class="anchored" data-anchor-id="part-a---mean-and-covariance-functions-for-y_t">Part (a) - <strong>Mean and Covariance Functions for ( {Y_t} )</strong></h3>
<section id="mean-of-y_t" class="level4">
<h4 class="anchored" data-anchor-id="mean-of-y_t"><strong>1. Mean of ( Y_t )</strong></h4>
<p>The expectation of ( Y_t ) is:</p>
<p><span class="math display">\[
E(Y_t) = E(e_t + c e_{t-1} + c e_{t-2} + \dots + c e_0)
\]</span></p>
<p>Since the error terms ( e_t ) are white noise with ( E(e_t) = 0 ), we have:</p>
<p><span class="math display">\[
E(Y_t) = 0
\]</span></p>
<p>Thus, the <strong>mean of ( Y_t )</strong> is:</p>
<p><span class="math display">\[
E(Y_t) = 0
\]</span></p>
</section>
<section id="covariance-function-of-y_t" class="level4">
<h4 class="anchored" data-anchor-id="covariance-function-of-y_t"><strong>2. Covariance Function of ( Y_t )</strong></h4>
<p>The covariance between ( Y_t ) and ( Y_{t+h} ) is:</p>
<p><span class="math display">\[
\text{Cov}(Y_t, Y_{t+h}) = \text{Cov}\left( e_t + c e_{t-1} + \dots + c e_0, e_{t+h} + c e_{t+h-1} + \dots + c e_{t+h-3} \right)
\]</span></p>
<p>Since the error terms are independent, only the terms where the indices overlap contribute to the covariance. For ( h = 0 ) (the variance of ( Y_t )), we have:</p>
<p><span class="math display">\[
\text{Var}(Y_t) = \sigma^2 \left( 1 + c^2 + c^2 + \dots \right)
\]</span></p>
<p>This is a sum of an infinite geometric series:</p>
<p><span class="math display">\[
\text{Var}(Y_t) = \sigma^2 \left( 1 + c^2 \sum_{k=0}^{\infty} 1 \right)
\]</span></p>
<p>Since the sum diverges, we conclude that <strong>( Y_t ) is not stationary</strong> because the variance is infinite due to the infinite sum. Therefore:</p>
<p><span class="math display">\[
\text{Var}(Y_t) = \infty
\]</span></p>
<p>Thus, ( Y_t ) is <strong>non-stationary</strong> because its variance does not converge.</p>
<hr>
</section>
</section>
<section id="part-b---mean-and-covariance-functions-for-y_t" class="level3">
<h3 class="anchored" data-anchor-id="part-b---mean-and-covariance-functions-for-y_t">Part (b) - <strong>Mean and Covariance Functions for ( {</strong>Y_t} )</h3>
<p>The first difference operator is defined as:</p>
<p><span class="math display">\[
\nabla Y_t = Y_t - Y_{t-1}
\]</span></p>
<p>Substituting for ( Y_t ) and ( Y_{t-1} ), we get:</p>
<p><span class="math display">\[
\nabla Y_t = \left( e_t + c e_{t-1} + c e_{t-2} + \dots \right) - \left( e_{t-1} + c e_{t-2} + c e_{t-3} + \dots \right)
\]</span></p>
<p>Simplifying:</p>
<p><span class="math display">\[
\nabla Y_t = e_t + c e_{t-1}
\]</span></p>
<section id="mean-of-y_t-1" class="level4">
<h4 class="anchored" data-anchor-id="mean-of-y_t-1"><strong>1. Mean of (</strong> Y_t )</h4>
<p>Taking the expectation:</p>
<p><span class="math display">\[
E(\nabla Y_t) = E(e_t + c e_{t-1}) = 0
\]</span></p>
<p>Thus, the <strong>mean of (</strong> Y_t ) is:</p>
<p><span class="math display">\[
E(\nabla Y_t) = 0
\]</span></p>
</section>
<section id="covariance-function-of-y_t-1" class="level4">
<h4 class="anchored" data-anchor-id="covariance-function-of-y_t-1"><strong>2. Covariance Function of (</strong> Y_t )</h4>
<p>The covariance between ( Y_t ) and ( Y_{t+h} ) is:</p>
<p><span class="math display">\[
\text{Cov}(\nabla Y_t, \nabla Y_{t+h}) = \text{Cov}(e_t + c e_{t-1}, e_{t+h} + c e_{t+h-1})
\]</span></p>
<p>Using the independence of the error terms:</p>
<p><span class="math display">\[
\text{Var}(\nabla Y_t) = \text{Var}(e_t + c e_{t-1}) = \sigma^2 (1 + c^2)
\]</span></p>
<p>Thus, the <strong>variance of (</strong> Y_t ) is:</p>
<p><span class="math display">\[
\text{Var}(\nabla Y_t) = \sigma^2 (1 + c^2)
\]</span></p>
<p>Since the variance is finite, ( Y_t ) is <strong>stationary</strong>.</p>
<hr>
</section>
</section>
<section id="part-c---identification-of-y_t-as-an-arima-process" class="level3">
<h3 class="anchored" data-anchor-id="part-c---identification-of-y_t-as-an-arima-process">Part (c) - <strong>Identification of ( Y_t ) as an ARIMA Process</strong></h3>
<p>The given process can be represented as:</p>
<p><span class="math display">\[
Y_t = e_t + c e_{t-1} + c e_{t-2} + c e_{t-3} + \dots
\]</span></p>
<p>This is a <strong>moving average (MA)</strong> process, as it involves a weighted sum of past error terms. Specifically, this can be represented as:</p>
<p><span class="math display">\[
Y_t = \sum_{i=0}^{\infty} c^i e_{t-i}
\]</span></p>
<p>This is an <strong>infinite order MA process</strong>, meaning it is an <strong>MA(∞)</strong> process.</p>
<p>In terms of ARIMA, this process has:</p>
<ul>
<li><strong>AR (autoregressive) order</strong> ( p = 0 ), since there are no autoregressive terms (no past values of ( Y_t )).</li>
<li><strong>Differencing order</strong> ( d = 0 ), as the series is not differenced.</li>
<li><strong>MA (moving average) order</strong> ( q = ), because it involves an infinite number of past errors.</li>
</ul>
<p>Therefore, we can identify ( Y_t ) as an <strong>ARIMA(0, 0, ∞)</strong> process.</p>
<hr>
</section>
</section>
<section id="summary-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-2">Summary</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Process</th>
<th>( E(Y_t) )</th>
<th>( (Y_t) )</th>
<th>Stationary?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>( Y_t )</td>
<td>0</td>
<td>( )</td>
<td>No</td>
</tr>
<tr class="even">
<td>( Y_t )</td>
<td>0</td>
<td>( ^2 (1 + c^2) )</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Identification</td>
<td>MA(∞)</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<section id="ex-5.15" class="level3">
<h3 class="anchored" data-anchor-id="ex-5.15">Ex 5.15</h3>
<p>Quarterly earnings per share for the Johnson &amp; Johnson Company are given in the data file named JJ. The data cover the years from 1960 through 1980.</p>
<ol type="a">
<li>Display a time series plot of the data. Interpret the interesting features in the plot</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'TSA':
  method       from    
  fitted.Arima forecast
  plot.Arima   forecast</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TSA'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    acf, arima</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    tar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"JJ"</span>) <span class="co"># Johnson &amp; Johnson quarterly earnings data from TSA package</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>jj <span class="ot">&lt;-</span> JJ</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>time_index <span class="ot">&lt;-</span> <span class="fu">time</span>(jj)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>jj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Qtr1      Qtr2      Qtr3      Qtr4
1960  0.710000  0.630000  0.850000  0.440000
1961  0.610000  0.690000  0.920000  0.550000
1962  0.720000  0.770000  0.920000  0.600000
1963  0.830000  0.800000  1.000000  0.770000
1964  0.920000  1.000000  1.240000  1.000000
1965  1.160000  1.300000  1.450000  1.250000
1966  1.260000  1.380000  1.860000  1.560000
1967  1.530000  1.590000  1.830000  1.860000
1968  1.530000  2.070000  2.340000  2.250000
1969  2.160000  2.430000  2.700000  2.250000
1970  2.790000  3.420000  3.690000  3.600000
1971  3.600000  4.320000  4.320000  4.050000
1972  4.860000  5.040000  5.040000  4.410000
1973  5.580000  5.850000  6.570000  5.310000
1974  6.030000  6.390000  6.930000  5.850000
1975  6.930000  7.740000  7.830000  6.120000
1976  7.740000  8.910000  8.280000  6.840000
1977  9.540000 10.260000  9.540000  8.729999
1978 11.880000 12.060000 12.150000  8.910000
1979 14.040000 12.960000 14.850000  9.990000
1980 16.200000 14.670000 16.020000 11.610000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (a) Display a time series plot of the data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">Time =</span> time_index, <span class="at">Earnings =</span> <span class="fu">as.numeric</span>(jj)), <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Earnings)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Quarterly Earnings per Share of Johnson &amp; Johnson (1960-1980)"</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Earnings per Share"</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>Use software to produce a plot similar to Exhibit 5.11, on page 102, and determine the “best” value of λ for a power transformation of these data.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (b) Find the best value of lambda for a power transformation</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">BoxCox.lambda</span>(jj)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Best value of lambda:"</span>, lambda, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Best value of lambda: 0.1540752 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot similar to Exhibit 5.11 (Box-Cox transformation plot)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>boxcox_results <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(jj <span class="sc">~</span> <span class="fu">time</span>(jj), <span class="at">lambda =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>lambda_max <span class="ot">&lt;-</span> boxcox_results<span class="sc">$</span>x[<span class="fu">which.max</span>(boxcox_results<span class="sc">$</span>y)]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Estimated lambda maximizing log-likelihood:"</span>, lambda_max, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated lambda maximizing log-likelihood: 0.06060606 </code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Display a time series plot of the transformed values. Does this plot suggest that a stationary model might be appropriate?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (c) Transform the data using the estimated lambda and plot</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>jj_transformed <span class="ot">&lt;-</span> <span class="fu">BoxCox</span>(jj, lambda)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">Time =</span> time_index, <span class="at">Earnings =</span> jj_transformed), <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Earnings)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"green"</span>) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Transformed Quarterly Earnings per Share (Box-Cox Transformation)"</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Transformed Earnings per Share"</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.
Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="a">
<li>Display a time series plot of the differences of the transformed values. Does this plot suggest that a stationary model might be appropriate for the differences?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (d) Difference the transformed data and plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>jj_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(jj_transformed)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>diff_time_index <span class="ot">&lt;-</span> time_index[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">Time =</span> diff_time_index, <span class="at">Earnings =</span> jj_diff), <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Earnings)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Differenced Transformed Quarterly Earnings per Share"</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Differenced Earnings per Share"</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ex-5.16" class="level2">
<h2 class="anchored" data-anchor-id="ex-5.16">Ex 5.16</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"gold"</span>) <span class="co"># Johnson &amp; Johnson quarterly earnings data from TSA package</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>gold <span class="ot">&lt;-</span> gold</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>gold</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time Series:
Start = 1 
End = 252 
Frequency = 1 
  [1] 426.80 425.50 425.80 423.15 421.25 422.55 421.70 424.65 421.70 422.85
 [11] 422.55 424.10 421.70 423.30 427.60 426.20 423.70 426.30 426.40 423.80
 [21] 421.15 421.90 419.80 416.50 414.50 411.50 413.20 413.50 417.05 422.80
 [31] 424.60 424.15 426.60 426.55 427.10 430.75 433.25 434.75 432.40 436.55
 [41] 434.65 429.15 433.25 429.65 433.60 434.85 439.90 440.20 440.95 442.75
 [51] 442.00 441.20 442.65 436.65 436.25 430.65 427.25 424.90 426.95 426.50
 [61] 427.50 427.45 425.95 423.70 426.60 426.40 425.40 428.10 429.15 428.85
 [71] 427.20 423.65 425.65 426.90 432.40 433.40 433.40 433.00 434.70 434.10
 [81] 432.75 433.20 429.20 429.20 430.50 429.70 425.80 426.90 428.35 426.25
 [91] 421.45 419.90 420.35 419.40 421.75 420.70 417.60 418.25 418.50 418.75
[101] 418.60 416.90 416.10 417.20 423.20 424.80 426.60 424.90 423.55 422.75
[111] 425.60 426.95 426.65 431.30 436.05 440.50 434.35 437.50 437.15 442.95
[121] 439.35 437.50 434.90 436.80 434.20 427.60 426.00 423.85 427.85 423.75
[131] 425.00 426.95 425.55 422.50 419.60 421.60 420.00 420.65 423.65 426.35
[141] 424.85 424.50 422.75 425.30 427.15 431.35 431.85 433.60 435.60 437.50
[151] 436.85 434.70 436.30 437.80 447.25 442.60 440.85 444.25 439.00 439.25
[161] 437.50 439.85 438.25 439.00 438.50 436.15 433.00 435.50 446.30 445.60
[171] 443.50 444.50 444.80 446.70 449.15 448.70 447.85 449.10 458.10 461.95
[181] 470.00 467.00 472.75 464.50 461.05 465.65 462.00 472.50 473.40 465.00
[191] 467.50 465.25 466.30 472.00 477.50 475.50 478.50 471.25 470.70 472.35
[201] 473.00 468.40 464.00 463.15 463.75 467.00 471.55 473.25 473.65 472.65
[211] 465.55 461.65 464.80 461.35 457.60 457.15 462.60 467.00 465.90 469.75
[221] 467.55 470.65 480.75 487.90 488.00 493.00 488.85 492.75 495.70 497.30
[231] 497.10 493.80 494.40 504.75 505.00 508.25 512.30 514.85 524.75 537.50
[241] 522.80 513.75 502.40 502.50 507.45 505.75 494.50 494.75 503.60 509.15
[251] 517.00 513.00</code></pre>
</div>
</div>
<p>a) Display the time series plot of these data. Interpret the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (a): Time series plot of the gold prices</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>gold_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Day =</span> <span class="fu">time</span>(gold), <span class="at">Price =</span> <span class="fu">as.numeric</span>(gold))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gold_df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Price)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"gold"</span>) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Daily Price of Gold (2005)"</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Day"</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Price (in dollars per troy ounce)"</span>) <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>Display the time series plot of the differences of the logarithms of these data. Interpret this plot.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (b): Differences of the logarithms of gold prices</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>log_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(gold))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>log_diff_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Day =</span> <span class="fu">time</span>(gold)[<span class="sc">-</span><span class="dv">1</span>], <span class="at">LogDiff =</span> log_diff)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(log_diff_df, <span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> LogDiff)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Differences of Logarithms of Gold Prices"</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Day"</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Log Differences"</span>) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="a">
<li>Calculate and display the sample ACF for the differences of the logarithms of these data and argue that the logarithms appear to follow a random walk model.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (c): Sample ACF for the differences of the logarithms</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(log_diff, <span class="at">main =</span> <span class="st">"Sample ACF of Differences of Logarithms"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="4" type="a">
<li>Display the differences of logs in a histogram and interpret.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (d): Histogram of the differences of logarithms</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(log_diff_df, <span class="fu">aes</span>(<span class="at">x =</span> LogDiff)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.002</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Histogram of Differences of Logarithms"</span>) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Log Differences"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Don't know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting
to continuous.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="5" type="a">
<li>Display the differences of logs in a quantile-quantile normal plot and interpret.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Part (e): Quantile-Quantile (Q-Q) plot for the differences of logarithms</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(log_diff, <span class="at">main =</span> <span class="st">"Q-Q Plot of Differences of Logarithms"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(log_diff, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tp5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>